# CLAUDE.md - fastapi

> Auto-generated by conventions-cli. Customize and extend with project-specific context.

## Project Overview

python project using fastapi.

FastAPI framework, high performance, easy to learn, fast to code, ready for production

## Directory Structure

- `.github/` — GitHub configuration
  - `DISCUSSION_TEMPLATE/`
  - `ISSUE_TEMPLATE/`
  - `workflows/`
- `docs/` — documentation
- `fastapi/` — source code
  - `_compat/`
  - `dependencies/`
  - `middleware/`
  - `openapi/`
  - `security/`
- `scripts/` — scripts
  - `playwright/`
  - `tests/`
    - `test_translation_fixer/`
- `tests/` — tests
  - `benchmarks/`
  - `test_modules_same_name_body/`
    - `app/`
  - `test_request_params/`
    - `test_body/`
    - `test_cookie/`
    - `test_file/`
    - `test_form/`
    - `test_header/`
    - `test_path/`
    - `test_query/`
  - `test_tutorial/`
  - `test_validate_response_recursive/`

## Architecture

### Key Patterns

- **API routes**: 29 endpoints (2 DELETE, 16 GET, 2 PATCH, 7 POST, 2 PUT)


### API Routes

- `fastapi/applications.py`: `GET /users/`, `GET /items/`, `GET /items/`, `GET /items/`, +4 more
- `fastapi/background.py`: `POST /send-notification/{email}`
- `fastapi/datastructures.py`: `POST /files/`, `POST /uploadfile/`
- `fastapi/exceptions.py`: `GET /items/{item_id}`
- `fastapi/param_functions.py`: `GET /items/{item_id}`, `GET /items/`, `GET /users/me/items/`
- `fastapi/routing.py`: `GET /users/`, `GET /items/`, `PUT /items/{item_id}`, `POST /items/`, +2 more
- `security/api_key.py`: `GET /items/`, `GET /items/`, `GET /items/`
- `security/http.py`: `GET /users/me`, `GET /users/me`, `GET /users/me`
- `security/oauth2.py`: `POST /login`, `POST /login`

## Tech Stack

- **Runtime**: python
- **CI/CD**: github_actions
- **Backend**: fastapi
- **Schema validation**: pydantic
- **Logging**: stdlib_logging
- **Testing**: pytest
- **Linting**: ruff

## Environment Setup

### Prerequisites

- **python**: 3.11 (from `.python-version`)

## Commands

- **Test**: `pytest`
- **Test single**: `pytest path/to/test.py::TestClass::test_method`

[TODO: Add project-specific commands]

## Conventions

- **Config access patterns**: Uses `pydantic_settings` for env config
- **Response envelope classes**: Uses response envelope classes (5 found).
- **Cursor-based pagination**: Uses cursor-based pagination. 8 cursor/after/before usages.
- **URL-based API versioning**: Uses URL path versioning (e.g., /v1/, /api/v2/)
- **Data class style: Pydantic for API + dataclasses for internal**: Uses Pydantic for API schemas (62) and dataclasses for internal DTOs (6). Good separation.
- **Background jobs with FastAPI BackgroundTasks**: Uses FastAPI BackgroundTasks for background task processing
- **Caching: functools.lru_cache**: Uses functools.lru_cache for caching.
- **Data classes: Pydantic models**: Uses Pydantic models for structured data. 84/98 structured classes use this pattern.
- **lowercase constant naming**: Uses lowercase naming for module-level values. 88/93 use lowercase.
- **Enum usage: Enum**: Uses Python enums for categorical values. Found 4 enum class(es).
- **FastAPI-style session dependency injection**: Uses get_db() dependency pattern with Depends() for session lifecycle
- **Python import path (flat-layout)**: flat-layout: `import fastapi`
- **PEP 8 snake_case naming**: Function names follow PEP 8 snake_case convention. 299/299 functions use snake_case. Found 20 module-level constants.
- **HTTP errors raised in service layer**: HTTPException is frequently raised outside the API layer
- **Semi-centralized exception handling**: Exception handlers are spread across 2 modules
- **Limited exception chaining**: Rarely uses 'raise X from Y'. 7/65 (11%) raises use chaining. Use 'raise X from Y' to preserve context or 'raise X from None' to suppress.
- **Context manager usage**: Uses context managers for resource management. 24 with statements (17 sync, 7 async). Types: file_io (2).
- **OAuth2 authentication**: Uses OAuth2 for authentication. OAuth2 usages: 13.
- **Structured configuration with Pydantic Settings**: Uses Pydantic BaseSettings for configuration management
- **Mocking with unittest.mock / Mock**: Uses unittest.mock / Mock for test mocking. Also uses: pytest monkeypatch fixture, @patch decorator.
- **Distributed test files**: Test files spread across 2 directories. 473 total test files.
- **Test naming: Simple style (test_feature)**: Uses Simple style (test_feature) naming. 2028/2070 (98%) test functions.
- **High type annotation coverage**: Type annotations are commonly used in this codebase. 363/367 functions (99%) have at least one type annotation.
- **Mixed validation approaches**: Uses multiple validation approaches: Pydantic validation, Manual validation (ValueError/TypeError).

[TODO: Add project-specific conventions]

## Deployment

- **CI features**: tests, deploy, caching, matrix builds

## Decision Log

[TODO: Record architectural decisions]

## Known Pitfalls

[TODO: Document gotchas and anti-patterns]
